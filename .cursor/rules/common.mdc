---
alwaysApply: true
---
# 通用开发规范

适用于所有子项目的通用开发规范。

## 规则文件说明

本项目采用模块化规则管理，包含以下规则文件：

1. **common.mdc** - 通用开发规范（所有项目都遵守，当前文件）
   - 交互规范
   - Go 语言通用规范
   - 安全规范
   - 版本控制规范
   - 代码质量要求

2. **admin.mdc** - 前端项目规范（仅适用于 admin/ 目录）
   - React + TypeScript 开发规范
   - 组件开发规范
   - API 请求规范
   - 路由与权限管理

3. **server.mdc** - 后端项目规范（仅适用于 server/ 目录）
   - Go + Gin 开发规范
   - 分层架构规范
   - API 设计规范
   - 数据库操作规范

4. **proxy.mdc** - 代理服务规范（仅适用于 proxy/ 目录）
   - 代理服务开发规范
   - 配置管理规范
   - 日志记录规范

**规则应用说明：**
- `common.mdc` 始终生效（`alwaysApply: true`）
- 其他规则文件根据路径自动应用（`pathGlob` 配置）
- 在对应目录下工作时，会自动应用相应的规则

---

## 1. 项目结构

项目采用 Monorepo 结构，包含3个子项目：
- **admin/** - 前端管理界面（React + UmiJS + Ant Design），端口 6806
- **server/** - 后端API服务（Go + Gin + GORM），端口 6808
- **proxy/** - 代理服务（Go），端口 6800

## 2. 交互规范

- 交互全程使用中文交流
- 修改代码前先描述方案，等待确认后再实施
- 修改结束后仅生成最终总结，不生成中间过程文档
- 只实现当前需求必要的功能，不写过度兼容的代码

## 3. 接口文档规范

- 接口改动后需更新对应 `docs/` 目录下的接口文档
- 接口文档按模块划分目录，一个接口对应一个文档文件
- 包含请求参数、响应格式、错误码说明

## 4. Go 语言通用规范（server、proxy）

### 4.1 代码组织
- 文件顶部必须包含包说明注释
- 单个文件不超过300行，超出需拆分
- 遵循 Go 标准项目布局：`cmd/`、`internal/`、`configs/`

### 4.2 命名规范
- 包名：小写，简短，无下划线或驼峰
- 函数/变量：驼峰命名，公开首字母大写
- 常量：全大写，下划线分隔
- 接口名：通常以 `er` 结尾

### 4.3 错误处理
- 所有可能出错的函数必须返回 error
- 错误信息使用中文，清晰明确
- 使用 `errors.New()` 或 `fmt.Errorf()` 创建错误
- 不忽略错误，必须处理或向上传递

### 4.4 注释规范
- 公开函数、类型、变量必须有注释
- 关键逻辑和复杂算法添加简明注释
- 注释解释代码作用和意图

## 5. 安全规范

### 5.1 输入验证
- 所有用户输入必须验证
- 防止 SQL 注入、XSS 等安全问题

### 5.2 认证安全
- JWT Secret 在生产环境必须修改为强密钥
- 管理员密码在生产环境必须修改为强密码
- Token 过期时间合理设置

### 5.3 日志安全
- 敏感信息（如密码、Token）不记录到日志
- 生产环境日志级别设置为 info 或 warn

## 6. 版本控制规范

- 不自动提交 Git，除非特别要求
- Git 提交遵循标准格式：`<type>: <subject>`
- type: feat, fix, docs, style, refactor, test, chore
- subject: 简短清晰的描述

## 7. 代码质量

### 7.1 代码检查
- 代码修改后必须通过 lint 检查
- 保持代码简洁、可读性强
- 避免重复代码

### 7.2 性能考虑
- 避免不必要的数据库查询
- 合理使用连接池
- 注意内存泄漏

## 8. 文档规范

### 8.1 README 文档
- 每个子项目都有独立的 README.md
- 包含项目说明、快速开始、配置说明、常见问题

### 8.2 代码文档
- 关键功能添加必要的注释说明
- 复杂逻辑需要解释设计意图
